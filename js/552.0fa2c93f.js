"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[552],{9552:function(t,s,o){o.r(s),o.d(s,{default:function(){return G}});var e=o(3396),a=o(7139),l=o(9242);const i={class:"container"},n={class:"row mt-4"},d={class:"col-md-7"},c={class:"table align-middle"},u=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"圖片"),(0,e._)("th",null,"商品名稱"),(0,e._)("th",null,"價格"),(0,e._)("th")])],-1),r={style:{width:"200px"}},p={href:"#",class:"text-dark"},h={key:0,class:"h5"},g={key:1,class:"h6"},_={key:2,class:"h5"},y={class:"btn-group btn-group-sm"},b=["onClick"],k=["disabled","onClick"],m={key:0,class:"spinner-grow spinner-grow-sm text-danger",role:"status"},w=(0,e._)("span",{class:"visually-hidden"},"Loading...",-1),v=[w],C={class:"col-md-5"},x={class:"sticky-top"},f={class:"table align-middle"},q=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th"),(0,e._)("th",null,"品名"),(0,e._)("th",{style:{width:"110px"}},"數量"),(0,e._)("th",null,"單價")])],-1),D=(0,e._)("td",null,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger btn-sm"},[(0,e._)("i",{class:"bi bi-x-lg"})])],-1),$={key:0,class:"text-success"},z={class:"input-group input-group-sm"},I=["onUpdate:modelValue","onChange","disabled"],L={class:"input-group-text"},U={class:"text-end"},P={key:0,class:"text-success"},V=(0,e._)("td",{colspan:"3",class:"text-end"},"總計",-1),j={class:"text-end"},H={key:0},Y=(0,e._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),K={class:"text-end text-success"},W={class:"input-group mb-3 input-group-sm"},Z={class:"input-group-append"};function A(t,s,o,w,A,B){const E=(0,e.up)("LoadingView");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(E,{active:A.isLoading},null,8,["active"]),(0,e._)("div",i,[(0,e._)("div",n,[(0,e._)("div",d,[(0,e._)("table",c,[u,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(A.products,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",r,[(0,e._)("div",{style:(0,a.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,e._)("td",null,[(0,e._)("a",p,(0,a.zw)(t.title),1)]),(0,e._)("td",null,[t.price?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",h,(0,a.zw)(t.origin_price)+" 元",1)),t.price?((0,e.wg)(),(0,e.iD)("del",g,"原價 "+(0,a.zw)(t.origin_price)+" 元",1)):(0,e.kq)("",!0),t.price?((0,e.wg)(),(0,e.iD)("div",_,"現在只要 "+(0,a.zw)(t.price)+" 元",1)):(0,e.kq)("",!0)]),(0,e._)("td",null,[(0,e._)("div",y,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:s=>B.getProduct(t.id)}," 查看更多 ",8,b),(0,e._)("button",{type:"button",class:"btn btn-outline-danger",disabled:this.status.loadingItem===t.id,onClick:s=>B.addCart(t.id)},[this.status.loadingItem===t.id?((0,e.wg)(),(0,e.iD)("div",m,v)):(0,e.kq)("",!0),(0,e.Uk)(" 加到購物車 ")],8,k)])])])))),128))])])]),(0,e._)("div",C,[(0,e._)("div",x,[(0,e._)("table",f,[q,(0,e._)("tbody",null,[A.cart.carts?((0,e.wg)(!0),(0,e.iD)(e.HY,{key:0},(0,e.Ko)(A.cart.carts,(s=>((0,e.wg)(),(0,e.iD)("tr",{key:s.id},[D,(0,e._)("td",null,[(0,e.Uk)((0,a.zw)(s.product.title)+" ",1),s.coupon?((0,e.wg)(),(0,e.iD)("div",$," 已套用優惠券 ")):(0,e.kq)("",!0)]),(0,e._)("td",null,[(0,e._)("div",z,[(0,e.wy)((0,e._)("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":t=>s.qty=t,onChange:t=>B.updateCart(s),disabled:s.id===A.status.loadingItem},null,40,I),[[l.nr,s.qty,void 0,{number:!0}]]),(0,e._)("div",L,"/ "+(0,a.zw)(s.product.unit),1)])]),(0,e._)("td",U,[s.final_total!==s.total?((0,e.wg)(),(0,e.iD)("small",P,"折扣價：")):(0,e.kq)("",!0),(0,e.Uk)(" "+(0,a.zw)(t.$filters.currency(s.final_total)),1)])])))),128)):(0,e.kq)("",!0)]),(0,e._)("tfoot",null,[(0,e._)("tr",null,[V,(0,e._)("td",j,(0,a.zw)(t.$filters.currency(A.cart.total)),1)]),A.cart.final_total!==A.cart.total?((0,e.wg)(),(0,e.iD)("tr",H,[Y,(0,e._)("td",K,(0,a.zw)(t.$filters.currency(A.cart.final_total)),1)])):(0,e.kq)("",!0)])]),(0,e._)("div",W,[(0,e.wy)((0,e._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":s[0]||(s[0]=t=>A.coupon_code=t)},null,512),[[l.nr,A.coupon_code]]),(0,e._)("div",Z,[(0,e._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[1]||(s[1]=(...t)=>B.addCuoponCode&&B.addCuoponCode(...t))}," 套用優惠碼 ")])])])])])])],64)}o(7658);var B={data(){return{products:[],product:{},cart:{},coupon_code:"",isLoading:!1,status:{loadingItem:""}}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/yang-leo-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,console.log("products",t),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const s="https://vue3-course-api.hexschool.io/api/yang-leo-api/cart";this.status.loadingItem=t;const o={product_id:t,qty:1};this.$http.post(s,{data:o}).then((t=>{console.log(t),this.status.loadingItem=""}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/yang-leo-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{console.log(t),this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){const s=`https://vue3-course-api.hexschool.io/api/yang-leo-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const o={product_id:t.product_id,qty:t.qty};this.$http.put(s,{data:o}).then((t=>{console.log(t),this.status.loadingItem="",this.getCart()}))},addCuoponCode(){const t="https://vue3-course-api.hexschool.io/api/yang-leo-api/coupon",s={code:this.coupon_code};this.$http.post(t,{data:s}).then((t=>{console.log(t),this.getCart()}))}},created(){this.getProducts(),this.getCart()}},E=o(89);const F=(0,E.Z)(B,[["render",A]]);var G=F}}]);
//# sourceMappingURL=552.0fa2c93f.js.map